(function(t){function e(e){for(var i,n,r=e[0],l=e[1],c=e[2],d=0,v=[];d<r.length;d++)n=r[d],s[n]&&v.push(s[n][0]),s[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(v.length)v.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],i=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(i=!1)}i&&(o.splice(e--,1),t=n(n.s=a[0]))}return t}var i={},s={app:0},o=[];function n(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=i,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/keep/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"093d":function(t,e,a){"use strict";var i=a("f0b3"),s=a.n(i);e["default"]=s.a},"0b02":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v("\n\tReport\n")])},s=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return s})},"12d3":function(t,e,a){},"3ab5":function(t,e,a){"use strict";var i=a("d4f2"),s=a.n(i);s.a},"554c":function(t,e,a){"use strict";var i=a("12d3"),s=a.n(i);s.a},"56d7":function(t,e,a){"use strict";a.r(e);var i=a("2b0e"),s=a("bb71");a("da64");i["a"].use(s["a"],{iconfont:"md"});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("keep-alive",[a("router-view")],1)],1)},n=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tabs",{attrs:{"fixed-tabs":""},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("v-tab-item",{attrs:{id:"tab1"}},[a("Home")],1),a("v-tab-item",{attrs:{id:"tab2"}},[a("Price")],1),a("v-tab-item",{attrs:{id:"tab3"}},[a("Report")],1),a("v-tabs-slider",{attrs:{color:"primary"}}),a("v-tab",{attrs:{href:"#tab1"}},[a("v-icon",[t._v("list")])],1),a("v-tab",{attrs:{href:"#tab2"}},[a("v-icon",[t._v("money")])],1),a("v-tab",{attrs:{href:"#tab3"}},[a("v-icon",[t._v("bar_chart")])],1)],1)},l=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"Home"},[a("v-list",[t._l(t.sortlist,function(e,i){return[0!==i?a("v-divider",{attrs:{inset:""}}):t._e(),a("v-list-tile",{attrs:{avatar:""},nativeOn:{click:function(a){t.$router.push({name:"goods",params:{gid:e.gid}})}}},[a("v-list-tile-avatar",{attrs:{size:"50"}},[a("img",{attrs:{src:e.image},on:{click:function(a){a.stopPropagation(),t.$router.push({name:"bill",params:{gid:e.gid}})}}}),a("div",{staticClass:"avatar-text"},[t._v(t._s(e.origin))])]),a("v-list-tile-content",[a("v-list-tile-title",[t._v(t._s(e.name)+" "+t._s(e.widget)+" "+t._s(e.spec))]),a("v-list-tile-sub-title",[t._v(t._s(e.logistics))]),a("v-list-tile-sub-title",{staticClass:"text--primary"},[a("span",{staticClass:"pink--text"},[t._v("¥"+t._s(e.costprice))]),a("span",{staticClass:"pink--text"},[t._v(" ¥"+t._s(e.price)+" ")]),a("span",{staticClass:"red--text"},[t._v("¥"+t._s(t._f("minus")(e.price,e.costprice)))])])],1)],1)]})],2),a("v-btn",{staticStyle:{bottom:"60px"},attrs:{fixed:"",dark:"",fab:"",bottom:"",right:"",color:"pink",to:"goods"}},[a("v-icon",[t._v("add")])],1)],1)},u=[],d=a("2f62");function v(t){const e=t.toString().split(/[eE]/),a=(e[0].split(".")[1]||"").length-+(e[1]||0);return a>0?a:0}function p(t,e=12){return+parseFloat(t.toPrecision(e))}function f(t,e=v(t)){const a=t.toString();let i=Number(a.replace(".",""));return e&&a.indexOf(".")<0&&(i=t*Math.pow(10,e)),i}function g(t,e){[].forEach.call(t,e)}function m(){const t=arguments[0],e=arguments[1],a=v(t)+v(e);let i=f(t)*f(e);if(a&&(i/=Math.pow(10,a)),arguments.length>2){let t=[].slice.call(arguments,2);return t.unshift(i),m.apply(null,t)}return i}function h(){let t=0;const e=Math.pow(10,Math.max.apply(Math,[].map.call(arguments,t=>v(t))));return g(arguments,a=>{t+=p(a*e)}),t/e}function b(){let t=0;const e=Math.pow(10,Math.max.apply(Math,[].map.call(arguments,t=>v(t))));return g(arguments,(a,i)=>{t-=p((i?a:-a)*e)}),t/e}function x(){const t=arguments[0],e=arguments[1],a=v(e)-v(t);let i=f(t)/f(e);if(a&&(i=m(i,Math.pow(10,a))),arguments.length>2){let t=[].slice.call(arguments,2);return t.unshift(i),x.apply(null,t)}return i}function _(t,e){const a=Math.pow(10,e);return x(Math.round(m(t,a)),a)}Math.times=m,Math.divide=x,Math.plus=h,Math.minus=b;var w={filters:{times:m,divide:x,plus:h,minus:b,round:_}},k={mixins:[w],computed:Object(d["c"])("goods",["sortlist"])},y=k,V=(a("c219"),a("2877")),$=a("6544"),O=a.n($),C=a("8336"),j=a("ce7e"),T=a("132d"),S=a("8860"),M=a("ba95"),E=a("c954"),D=a("5d23"),q=Object(V["a"])(y,c,u,!1,null,null,null);q.options.__file="Home.vue";var I=q.exports;O()(q,{VBtn:C["a"],VDivider:j["a"],VIcon:T["a"],VList:S["a"],VListTile:M["a"],VListTileAvatar:E["a"],VListTileContent:D["a"],VListTileSubTitle:D["b"],VListTileTitle:D["c"]});var P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"Price"},[a("v-list",[t._l(t.sortlist,function(e,i){return[i>0?a("v-divider",{attrs:{inset:""}}):t._e(),a("v-list-tile",[a("v-list-tile-action",[a("v-checkbox",{model:{value:t.selection[e.gid],callback:function(a){t.$set(t.selection,e.gid,a)},expression:"selection[item.gid]"}})],1),a("v-list-tile-avatar",{attrs:{size:"50"},on:{click:function(a){t.selection[e.gid]=!t.selection[e.gid]}}},[a("img",{attrs:{src:e.image}})]),a("v-list-tile-content",[a("v-list-tile-title",[t._v(t._s(e.name)+" "+t._s(e.origin))]),a("v-list-tile-sub-title",[i!==t.sortlist.length-1?a("v-btn",{attrs:{small:"",flat:"",icon:""},on:{click:function(e){e.stopPropagation(),t.doSort(i,t.sortlist.length-1)}}},[a("v-icon",[t._v("vertical_align_bottom")])],1):t._e(),0!==i?a("v-btn",{attrs:{small:"",flat:"",icon:""},on:{click:function(e){e.stopPropagation(),t.doSort(i,0)}}},[a("v-icon",[t._v("vertical_align_top")])],1):t._e(),i!==t.sortlist.length-1?a("v-btn",{attrs:{small:"",flat:"",icon:""},on:{click:function(e){e.stopPropagation(),t.doSort(i,i+1)}}},[a("v-icon",[t._v("arrow_downward")])],1):t._e(),0!==i?a("v-btn",{attrs:{small:"",flat:"",icon:""},on:{click:function(e){e.stopPropagation(),t.doSort(i,i-1)}}},[a("v-icon",[t._v("arrow_upward")])],1):t._e()],1)],1)],1)]})],2),a("v-btn",{staticStyle:{bottom:"60px"},attrs:{fixed:"",dark:"",fab:"",bottom:"",right:"",color:"pink"},on:{click:t.toImage}},[a("v-icon",[t._v("image")])],1)],1)},R=[],L={computed:{...Object(d["c"])("goods",["sortlist"]),...Object(d["d"])("goods",["selection"])},methods:{...Object(d["b"])("goods",["sort"]),toImage(){this.$router.push({name:"imagecreate",params:{data:this.sortlist.filter(t=>this.selection[t.gid])}})},doSort(t,e){this.sort({index:t,toIndex:e})}}},A=L,F=(a("3ab5"),a("ac7c")),B=a("40fe"),U=Object(V["a"])(A,P,R,!1,null,null,null);U.options.__file="Price.vue";var z=U.exports;O()(U,{VBtn:C["a"],VCheckbox:F["a"],VDivider:j["a"],VIcon:T["a"],VList:S["a"],VListTile:M["a"],VListTileAction:B["a"],VListTileAvatar:E["a"],VListTileContent:D["a"],VListTileSubTitle:D["b"],VListTileTitle:D["c"]});var H=a("762c"),G=new i["a"]({data(){return{goodsSelection:{}}}}),N={components:{Home:I,Price:z,Report:H["default"]},data(){return{active:"tab1"}},watch:{active(t){G.$emit("view.show."+{tab1:"Home",tab2:"Price",tab3:"Report"}[t],t)}}},Z=N,J=(a("981f"),a("71a3")),W=a("c671"),Y=a("fe57"),K=a("9a96"),Q=Object(V["a"])(Z,r,l,!1,null,null,null);Q.options.__file="Tabs.vue";var X=Q.exports;O()(Q,{VIcon:T["a"],VTab:J["a"],VTabItem:W["a"],VTabs:Y["a"],VTabsSlider:K["a"]});var tt={name:"App",components:{Tabs:X}},et=tt,at=(a("7faf"),a("7496")),it=Object(V["a"])(et,o,n,!1,null,null,null);it.options.__file="App.vue";var st=it.exports;O()(it,{VApp:at["a"]});var ot=a("8c4f"),nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-toolbar",{attrs:{fixed:"",dark:"",color:"primary"}},[a("v-btn",{attrs:{icon:""},on:{click:function(e){t.$router.go(-1)}}},[a("v-icon",[t._v("arrow_back")])],1),a("v-toolbar-title",[t._v("商品")]),a("v-spacer"),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("delete")])],1),a("v-btn",{attrs:{type:"submit",icon:""},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[a("v-icon",[t._v("save")])],1)],1),a("div",{staticClass:"header-padding"}),a("v-card",[a("FileSelector",{attrs:{accept:"image/*",value:t.values.image,placeholder:"选择图片"},on:{input:t.onImageChange}},[a("v-img",{attrs:{src:t.values.image,"aspect-ratio":"2.75"}})],1),a("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[a("v-text-field",{attrs:{label:"名称",required:"",rules:t.rules.name,"validate-on-blur":""},model:{value:t.values.name,callback:function(e){t.$set(t.values,"name",e)},expression:"values.name"}}),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{label:"产地",required:"",rules:t.rules.origin,"validate-on-blur":""},model:{value:t.values.origin,callback:function(e){t.$set(t.values,"origin",e)},expression:"values.origin"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{label:"重量",required:"",rules:t.rules.widget,"validate-on-blur":""},model:{value:t.values.widget,callback:function(e){t.$set(t.values,"widget",e)},expression:"values.widget"}})],1)],1)],1)],1),a("v-card",[a("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{type:"number",min:"0",label:"代理价",required:"",rules:t.rules.costprice,"validate-on-blur":""},model:{value:t.values.costprice,callback:function(e){t.$set(t.values,"costprice",t._n(e))},expression:"values.costprice"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{type:"number",label:"零售价",required:"",rules:t.rules.price,"validate-on-blur":""},model:{value:t.values.price,callback:function(e){t.$set(t.values,"price",t._n(e))},expression:"values.price"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-checkbox",{attrs:{label:"上架"},model:{value:t.values.active,callback:function(e){t.$set(t.values,"active",e)},expression:"values.active"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{label:"数量",required:"",rules:t.rules.spec,"validate-on-blur":""},model:{value:t.values.spec,callback:function(e){t.$set(t.values,"spec",e)},expression:"values.spec"}})],1)],1),a("v-text-field",{attrs:{label:"物流",required:"",rules:t.rules.logistics,"validate-on-blur":""},model:{value:t.values.logistics,callback:function(e){t.$set(t.values,"logistics",e)},expression:"values.logistics"}})],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.dialogOptions.show,callback:function(e){t.$set(t.dialogOptions,"show",e)},expression:"dialogOptions.show"}},[a("v-card",[a("v-card-text",[t._v(t._s(t.dialogOptions.content))]),a("v-card-actions",[a("v-spacer"),t._l(t.dialogOptions.btns,function(e,i){return a("v-btn",{key:i,attrs:{flat:"",color:e.color},on:{click:function(a){t.dialogBtnClick(e)}}},[t._v(t._s(e.text))])})],2)],1)],1)],1)},rt=[],lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",[a("input",{ref:"input",attrs:{type:"file",accept:t.accept,multiple:t.multiple},on:{change:t.change}}),t._t("default"),t.value?t._e():a("div",{staticClass:"placeholder"},[t._v("\n\t\t"+t._s(t.placeholder)+"\n\t")])],2)},ct=[],ut={props:{value:"",accept:"",multiple:"",placeholder:""},methods:{change(t){this.$emit("input",[].slice.call(t.target.files)),this.$refs.input.value=null}}},dt=ut,vt=(a("c2c6"),Object(V["a"])(dt,lt,ct,!1,null,"567f8d5a",null));vt.options.__file="FileSelector.vue";var pt=vt.exports;const ft={required:function(t){return t.toString().trim().length>0||"必填项"},tel:function(t){return!!/^1\d{10}$/.test(t)||"格式错误"},gtZero:function(t){return t>0||"应大于 0"},gtOrEqualZero:function(t){return t>=0||"应大于等于 0"}};var gt=ft;const mt=document.createElement("canvas"),ht=mt.getContext("2d");var bt=function(t,e=400){return new Promise((a,i)=>{const s=URL.createObjectURL(t),o=new Image;o.src=s,o.onload=function(){ht.clearRect(0,0,mt.width,mt.height),e=Math.min(e,o.width,o.height),mt.width=e,mt.height=e;const t=Math.ceil((o.width-o.height)/2),i=Math.min(o.width,o.height);ht.drawImage(o,t>0?t:0,t<0?-t:0,i,i,0,0,e,e),a(mt.toDataURL())},o.onerror=function(t){i(t)}})};function xt(){return{show:!1,title:"",content:"",btns:[{role:"cancel",color:"green darken-1",text:"取消"},{role:"ok",color:"blue darken-1",text:"确定"}]}}var _t={data(){return{dialogOptions:xt()}},methods:{openDialog(t={}){return this.dialogPromise=new Promise(e=>{t.show=!0,this.dialogResolve=e,this.dialogOptions=Object.assign(xt(),t)})},dialogBtnClick(t){this.dialogResolve(t),this.dialogPromise.then(t=>{t&&(this.dialogOptions.show=!1)})}}},wt={deactivated(){Object.assign(this.$data,this.$options.data())}},kt={components:{FileSelector:pt},mixins:[_t,wt],activated(){this.fetchData()},beforeRouteLeave(t,e,a){this.$refs.form.validate()?a():(a(!1),this.openDialog({content:"还没有保存，确定退出?"}).then(t=>{"ok"==t.role?a():a(!1)}))},data(){return{valid:!0,rules:{name:[gt.required],origin:[gt.required],widget:[gt.required],spec:[gt.required],costprice:[gt.required,gt.gtZero],price:[gt.required,gt.gtOrEqualZero],logistics:[gt.required]},values:{gid:"",gtid:"",image:"",name:"",origin:"",widget:"",spec:"",shelflife:-1,costprice:1,price:1,logistics:"",sort:0,active:!0,delete:!1,remark:null,createtime:Date.now(),modifytime:null,json:null}}},computed:Object(d["c"])("goods",["get"]),methods:{...Object(d["b"])("goods",["put"]),onImageChange(t){Promise.all(t.map(t=>bt(t,400))).then(t=>{this.values.image=t[0]})},fetchData(){Object.assign(this.values,this.get(this.$route.params.gid))},submit(){this.$refs.form.validate()&&this.put(Object.assign({},this.values)).then(()=>{return history.back()})}}},yt=kt,Vt=(a("9bfe"),a("b0af")),$t=a("99d9"),Ot=a("a523"),Ct=a("169a"),jt=a("0e8f"),Tt=a("4bd4"),St=a("adda"),Mt=a("a722"),Et=a("9910"),Dt=a("2677"),qt=a("71d9"),It=a("2a7f"),Pt=Object(V["a"])(yt,nt,rt,!1,null,"1c32b87e",null);Pt.options.__file="Goods.vue";var Rt=Pt.exports;O()(Pt,{VBtn:C["a"],VCard:Vt["a"],VCardActions:$t["a"],VCardText:$t["b"],VCheckbox:F["a"],VContainer:Ot["a"],VDialog:Ct["a"],VFlex:jt["a"],VForm:Tt["a"],VIcon:T["a"],VImg:St["a"],VLayout:Mt["a"],VSpacer:Et["a"],VTextField:Dt["a"],VToolbar:qt["a"],VToolbarTitle:It["a"]});var Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-toolbar",{attrs:{fixed:"",dark:"",color:"primary"}},[a("v-btn",{attrs:{icon:""},on:{click:function(e){t.$router.go(-1)}}},[a("v-icon",[t._v("arrow_back")])],1),a("v-toolbar-title",[t._v("开单")]),a("v-spacer"),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("delete")])],1),a("v-btn",{attrs:{type:"submit",icon:""},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[a("v-icon",[t._v("save")])],1)],1),a("div",{staticClass:"header-padding"}),a("v-card",[a("v-img",{attrs:{src:t.goods.image,"aspect-ratio":"2.75"}}),a("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[a("v-text-field",{attrs:{disabled:"",label:"名称","hide-details":""},model:{value:t.goods.name,callback:function(e){t.$set(t.goods,"name",e)},expression:"goods.name"}}),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{disabled:"",label:"代理价","hide-details":""},model:{value:t.values.costprice,callback:function(e){t.$set(t.values,"costprice",e)},expression:"values.costprice"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{disabled:"",label:"零售价","hide-details":""},model:{value:t.values.price,callback:function(e){t.$set(t.values,"price",e)},expression:"values.price"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{label:"优惠额",min:"0"},model:{value:t.values.offer,callback:function(e){t.$set(t.values,"offer",e)},expression:"values.offer"}})],1),a("v-flex",{attrs:{xs6:""}},[a("v-checkbox",{attrs:{label:"已收款"},model:{value:t.values.income,callback:function(e){t.$set(t.values,"income",e)},expression:"values.income"}})],1)],1)],1)],1),a("v-card",[a("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs6:""}},[a("v-text-field",{attrs:{type:"date",label:"日期",required:""},model:{value:t.values.billtime,callback:function(e){t.$set(t.values,"billtime",e)},expression:"values.billtime"}})],1)],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.dialogOptions.show,callback:function(e){t.$set(t.dialogOptions,"show",e)},expression:"dialogOptions.show"}},[a("v-card",[a("v-card-text",[t._v(t._s(t.dialogOptions.content))]),a("v-card-actions",[a("v-spacer"),t._l(t.dialogOptions.btns,function(e,i){return a("v-btn",{key:i,attrs:{flat:"",color:e.color},on:{click:function(a){t.dialogBtnClick(e)}}},[t._v(t._s(e.text))])})],2)],1)],1)],1)},At=[];function Ft(){var t=Date.now();return"undefined"!==typeof performance&&"function"===typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?a:3&a|8).toString(16)})}function Bt(t,e){const a=new Date(t),i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};return/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),Object.keys(i).forEach(t=>{new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[t]:("00"+i[t]).substr((""+i[t]).length)))}),e}var Ut={mixins:[_t,wt],activated(){this.fetchData()},beforeRouteLeave(t,e,a){this.$refs.form.validate()?a():(a(!1),this.openDialog({content:"还没有保存，确定退出?"}).then(t=>{"ok"==t.role?a():a(!1)}))},data(){return{valid:!0,goods:{image:"",name:"",origin:""},customer:{name:"",wx:"",qq:"",tel:""},receiver:{name:"",tel:"",address:""},values:{bid:"",gid:"",cid:"",rid:"",aid:"",costprice:1,price:0,widget:"",spec:"",profit:0,offer:0,income:!0,remark:"",billtime:Bt(Date.now(),"yyyy-MM-dd"),modifytime:null,createtime:Date.now(),json:null}}},computed:Object(d["c"])("goods",{getGoods:"get"}),methods:{fetchData(){if(this.$route.params.gid){const t=this.getGoods(this.$route.params.gid);Object.assign(this.goods,t),["gid","constprice","price","widget","spec"].forEach(e=>{this.values[e]=t[e]})}else if(this.$route.params.bid){const t=this.get(this.$route.params.bid);Object.assign(this.goods,this.getGoods(t.gid)),Object.assign(this.customer,this.getCustomer(t.cid)),Object.assign(this.receiver,this.getReceiver(t.rid))}},submit(){}}},zt=Ut,Ht=(a("5b22"),Object(V["a"])(zt,Lt,At,!1,null,"09fec4a6",null));Ht.options.__file="Bill.vue";var Gt=Ht.exports;O()(Ht,{VBtn:C["a"],VCard:Vt["a"],VCardActions:$t["a"],VCardText:$t["b"],VCheckbox:F["a"],VContainer:Ot["a"],VDialog:Ct["a"],VFlex:jt["a"],VForm:Tt["a"],VIcon:T["a"],VImg:St["a"],VLayout:Mt["a"],VSpacer:Et["a"],VTextField:Dt["a"],VToolbar:qt["a"],VToolbarTitle:It["a"]});var Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-toolbar",{attrs:{fixed:"",dark:"",color:"primary"}},[a("v-btn",{attrs:{icon:""},on:{click:function(e){t.$router.go(-1)}}},[a("v-icon",[t._v("arrow_back")])],1),a("v-toolbar-title",[t._v("价表生成")])],1),a("div",{staticClass:"header-padding"}),a("v-card",[a("v-container",{attrs:{"grid-list-xl":"","text-xs-center":""}},[a("v-select",{attrs:{items:t.templateItems,label:"模板"},model:{value:t.values.template,callback:function(e){t.$set(t.values,"template",e)},expression:"values.template"}}),a("v-slider",{attrs:{min:"35",max:"100",step:"5","tick-size":"3","thumb-size":"28",label:"质量","hide-details":"",ticks:"","thumb-label":"always"},nativeOn:{touchend:function(t){t.stopPropagation()}},model:{value:t.values.quality,callback:function(e){t.$set(t.values,"quality",e)},expression:"values.quality"}}),a("v-slider",{attrs:{min:"20",max:"100",step:"5","tick-size":"3","thumb-size":"28",label:"缩放","hide-details":"",ticks:"","thumb-label":"always"},nativeOn:{touchend:function(t){t.stopPropagation()}},model:{value:t.values.scale,callback:function(e){t.$set(t.values,"scale",e)},expression:"values.scale"}})],1)],1),a("div",{ref:"box",staticClass:"box"},[a("div",{ref:"list",staticClass:"price-list"},t._l(t.list,function(e,i){return a("div",{staticClass:"template1"},[a("img",{attrs:{src:e.image}}),a("div",{staticClass:"itemcontent"},[a("div",{staticClass:"text name-row"},[a("span",[a("span",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" ("+t._s(e.origin)+") "+t._s(e.widget))])]),a("div",{staticClass:"text logistics-row"},[a("span",[t._v(t._s(e.logistics))])]),a("div",{staticClass:"text price-row"},[a("span",{staticClass:"price"},[t._v("¥"+t._s(e.price))]),t._v(" "),a("span",[t._v("("+t._s(e.spec)+")")])])])])}))]),a("v-btn",{staticStyle:{bottom:"60px"},attrs:{fixed:"",dark:"",fab:"",bottom:"",right:"",color:"pink"},on:{click:t.download}},[a("v-icon",[t._v("arrow_downward")])],1),a("div",{staticStyle:{height:"0",overflow:"hidden"}},[a("canvas",{ref:"canvas"})])],1)},Zt=[],Jt=a("74ce");const Wt=new Jt["a"]("keep");Wt.version(1).stores({gtype:"gtid",goods:"gid",customer:"cid",receiver:"rid",account:"aid",bill:"bid"});var Yt=Wt;const Kt=document.createElement("a");Kt.innerText="下载";var Qt=function(t,e){Kt.download=e||Date.now(),Kt.href=t,Kt.click()},Xt=a("951f"),te=a.n(Xt),ee={activated(){this.fetchData()},data(){return{templateItems:["默认模板"],list:[],values:{template:"默认模板",scale:100,quality:100}}},methods:{fetchData(){this.list=this.$route.params.data},scaleUI(){function t(e,a){e.scrollWidth>e.clientWidth&&a>12&&(a--,e.firstElementChild.style.fontSize=a+"px",t(e,a))}this.$nextTick(()=>{this.$refs.list.clientWidth&&([].slice.call(this.$refs.list.querySelectorAll(".text")).forEach(e=>{t(e,parseInt(getComputedStyle(e.firstElementChild).fontSize))}),this.$refs.box.style.height=this.$refs.list.getBoundingClientRect().height+"px")})},download(){te()(this.$refs.list,{canvas:this.$refs.canvas}).then(t=>{const e=window.devicePixelRatio||1,a=t.getContext("2d"),i=t.width/2,s=t.height/2,o=a.getImageData(0,0,i,s);let n=i,r=s;if(t.width=n,t.height=r,100!==this.values.scale){n=Math.floor(i*this.values.scale/100),r=Math.floor(s*this.values.scale/100);const e=document.createElement("canvas"),l=e.getContext("2d");e.width=i,e.height=s,l.putImageData(o,0,0),t.width=n,t.height=r,a.drawImage(e,0,0,i,s,0,0,n,r)}else a.putImageData(o,0,0);t.style.width=n/e+"px",t.style.height=r/e+"px",t.toBlob(t=>{const e=URL.createObjectURL(t);Qt(e,`价格表${(new Date).toJSON()}.jpg`),URL.revokeObjectURL(e)},"image/jpeg",this.values.quality/100)})}},watch:{list(){this.scaleUI()}}},ae=ee,ie=(a("554c"),a("b56d")),se=a("ba0d"),oe=Object(V["a"])(ae,Nt,Zt,!1,null,"6a121272",null);oe.options.__file="ImageCreate.vue";var ne=oe.exports;O()(oe,{VBtn:C["a"],VCard:Vt["a"],VContainer:Ot["a"],VIcon:T["a"],VSelect:ie["a"],VSlider:se["a"],VToolbar:qt["a"],VToolbarTitle:It["a"]}),i["a"].use(ot["a"]);var re=new ot["a"]({mode:"history",base:"/keep/",routes:[{path:"/",name:"tabs",component:X},{path:"/goods",name:"goods",component:Rt},{path:"/bill",name:"bill",component:Gt},{path:"/imagecreate",name:"imagecreate",component:ne}]});const le={data:[],selection:{}};Yt.goods.toArray().then(t=>{le.data.push(...t),le.data.forEach(t=>{le.selection[t.gid]=!1})});var ce={namespaced:!0,state:le,mutations:{update(t,e){t.data.some(t=>{if(t.gid===e.gid)return Object.assign(t,e),!0})},add(t,e){t.data.push(e),t.selection[e.gid]=!1}},actions:{put({commit:t,getters:e,dispatch:a},i){return i.gid?(i.modifytime=Date.now(),a("update",i)):(i.gid=Ft(),i.sort=(e.sortlist[0]||{sort:1}).sort-1,i.createtime=Date.now(),a("add",i))},update({commit:t},e){return Yt.goods.update(e.gid,e).then(()=>{t("update",e)})},add({commit:t},e){return Yt.goods.add(e).then(()=>{t("add",e)})},sort({state:t,dispatch:e},{index:a,toIndex:i}){t.data.splice(i,0,...t.data.splice(a,1)),t.data.forEach((t,a)=>{e("update",{gid:t.gid,sort:a})})}},getters:{get(t,e){return t=>e.indexes[t]},sortlist(t){return t.data.slice(0).sort((t,e)=>{return t.sort>e.sort?1:-1})},indexes(t){const e={};return t.data.forEach(t=>{e[t.gid]=t}),e}}};i["a"].use(d["a"]);var ue=new d["a"].Store({modules:{goods:ce},mutations:{},actions:{}}),de=a("9483");Object(de["a"])("/keep/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached(){console.log("Content has been cached for offline use.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}}),i["a"].config.productionTip=!1,new i["a"]({router:re,store:ue,render:t=>t(st)}).$mount("#app")},"5b22":function(t,e,a){"use strict";var i=a("90c3"),s=a.n(i);s.a},"694c":function(t,e,a){},"6b47":function(t,e,a){},"762c":function(t,e,a){"use strict";var i=a("0b02"),s=a("093d"),o=(a("ffcc"),a("2877")),n=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,null,null);n.options.__file="Report.vue",e["default"]=n.exports},"7faf":function(t,e,a){"use strict";var i=a("f3f7"),s=a.n(i);s.a},"90c3":function(t,e,a){},"981f":function(t,e,a){"use strict";var i=a("a983"),s=a.n(i);s.a},"9bfe":function(t,e,a){"use strict";var i=a("f24d"),s=a.n(i);s.a},a983:function(t,e,a){},b9e2:function(t,e,a){},c219:function(t,e,a){"use strict";var i=a("6b47"),s=a.n(i);s.a},c2c6:function(t,e,a){"use strict";var i=a("694c"),s=a.n(i);s.a},d4f2:function(t,e,a){},f0b3:function(t,e){},f24d:function(t,e,a){},f3f7:function(t,e,a){},ffcc:function(t,e,a){"use strict";var i=a("b9e2"),s=a.n(i);s.a}});
//# sourceMappingURL=app.e63ac93b.js.map